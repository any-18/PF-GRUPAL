<!DOCTYPE html>
<html>
    <head>
        <title>MapAny</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
        <script defer src='http://maps.googleapis.com/maps/api/js?key=AIzaSyDclWfFnp7AQpJjZQj7E9fsD7j6M9vPhTk&callback=initMap'></script>
        <script>
            let map;
            let marker;
            let watchID;
            let geoLoc;

            function initMap() {
                const myLatLng = {lat: 3.0216252 , lng: -76.4678653};
                map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 4,
                    center: myLatLng
                });
                marker = new google.maps.Marker({
                    position: myLatLng,
                    map,
                    title: "Hello Word"
                });
                getPosition();
            }

            function getPosition() {
                if(navigator.geolocation) {
                    var options = {timeout:60000};
                    geoLoc = navigator.geolocation; 
                    watchID = geoLoc.watchPosition(showLocationOnMap, errorHandler, options)
                } else {
                    alert("Lo sentimos, el explorador no soporta geolocalizacion");
                }
            }

            function showLocationOnMap(position) {
                var latitud = position.coords.latitude;
                var longitud = position.coords.longitude;
                console.log("latitud: " + latitud + " Longitud: " + longitud);

                const myLatLng = {  lat: latitud, lng: longitud};
                marker.setPosition(myLatLng);
                map.setCenter(myLatLng);
            }

            function errorHandler(err) {
                if(err.code == 1) {
                    alert("Error: Acceso denegado");
                } else if(err.code == 2) {
                    alert("Error: Position no existe o no se encuentra");
                }
            }
        </script>
        <style type="text/css">
        #map {
            height: 100%;
        }
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        </style>
    </head>
    <body>
        <div id="map"></div>
    </body>
</html>